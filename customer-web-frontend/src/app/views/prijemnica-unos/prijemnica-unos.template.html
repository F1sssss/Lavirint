<div class="container">
    <div class="mt-3"></div>
    <div class="card">
        <div class="card-header">
            <div class="fw-bold text-uppercase">Osnovne informacije</div>
        </div>
        <div class="card-body">
            <form name="ctrl.forma" novalidate>
                <div class="row g-3">
                    <div class="col-12 col-md-6 col-lg-3">
                        <div class="form-group">
                            <label for="prijemnica-magacin-id" class="form-label">Magacin</label>
                            <ui-select id="prijemnica-magacin-id" name="magacin_id" ng-model="ctrl.prijemnica.magacin_id" theme="select2" search-enabled="true">
                                <ui-select-match placeholder="&nbsp;">
                                    <span ng-bind="$select.selected.naziv"></span>
                                </ui-select-match>
                                <ui-select-choices repeat="item.id as item in (ctrl.magacini | filter: $select.search) track by item.id">
                                    <span ng-bind="item.naziv"></span>
                                </ui-select-choices>
                            </ui-select>
                            <div ng-messages="ctrl.forma.magacin_id.$error" role="alert" class="invalid-feedback">
                                <div ng-messages-include="error-messages"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-3">
                        <div class="form-group">
                            <label for="prijemnica-dobavljac-id" class="form-label">Dobavlja훾</label>
                            <!-- TODO autofocus -->
                            <ui-select id="prijemnica-dobavljac-id" name="dobavljac_id" ng-model="ctrl.prijemnica.dobavljac_id" theme="select2" search-enabled="true">
                                <ui-select-match placeholder="&nbsp;">
                                    <span ng-bind="$select.selected.naziv"></span>
                                </ui-select-match>
                                <ui-select-choices repeat="item.id as item in (ctrl.komitenti | filter: $select.search) track by item.id">
                                    <span ng-bind="item.naziv"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-3">
                        <div class="form-group">
                            <label for="prijemnica-broj-ulazne-fakture" class="form-label">Broj ulazne fakture</label>
                            <input type="text" class="form-control" name="broj_ulazne_fakture" id="prijemnica-broj-ulazne-fakture" ng-model="ctrl.prijemnica.broj_ulazne_fakture">
                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-3">
                        <div class="form-group">
                            <label for="faktura-datum-ulazne-fakture" class="form-label">Datum ulazne fakture</label>
                            <div class="input-group">
                                <input type="text" class="form-control" uib-datepicker-popup is-open="datum_ulazne_fakture_is_opened" name="datum_ulazne_fakture" id="faktura-datum-ulazne-fakture" ng-model="ctrl.prijemnica.datum_ulazne_fakture">
                                <button type="button" class="btn btn-dark" ng-click="datum_ulazne_fakture_is_opened = !datum_ulazne_fakture_is_opened">
                                    <i class="fa fa-calendar"></i>
                                </button>
                            </div>
                            <div ng-messages="ctrl.forme.racun.datum_ulazne_fakture.$error" role="alert" class="invalid-feedback">
                                <div ng-messages-include="error-messages"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="mt-3"></div>
    <div class="card">
        <div class="card-header">
            <div class="fw-bold text-uppercase">Stavke prijemnice</div>
        </div>
        <div class="card-body">
            <form name="ctrl.formaStavka" novalidate>
                <div class="row g-3">
                    <div class="col-12 col-md-6 col-lg-3">
                        <div class="form-group">
                            <label for="prijemnica-stavka-kolicina" class="form-label">Koli훾ina</label>
                            <input type="number" class="form-control" name="kolicina" id="prijemnica-stavka-kolicina" ng-model="ctrl.stavka.kolicina" required min="0.001" step="0.001" ng-class="{ 'is-invalid': ctrl.formaStavka.$submitted && ctrl.formaStavka.kolicina.$invalid }">
                            <div ng-messages="ctrl.formaStavka.kolicina.$error" role="alert" class="invalid-feedback">
                                <div ng-messages-include="error-messages"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-6">
                        <div class="form-group">
                            <label for="prijemnica-artikal-id" class="form-label">Artikal</label>
                            <ui-select id="prijemnica-artikal-id" name="artikal" ng-model="ctrl.stavka.artikal" theme="select2" search-enabled="true" required ng-class="{ 'is-invalid': ctrl.formaStavka.$submitted && ctrl.formaStavka.artikal.$invalid }">
                                <ui-select-match placeholder="&nbsp;">
                                    <span ng-bind="$select.selected.naziv"></span>
                                </ui-select-match>
                                <ui-select-choices repeat="item as item in (ctrl.artikli | filter: $select.search)">
                                    <span ng-bind="item.naziv"></span>
                                </ui-select-choices>
                            </ui-select>
                            <div ng-messages="ctrl.formaStavka.artikal.$error" role="alert" class="invalid-feedback">
                                <div ng-messages-include="error-messages"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-3">
                        <button class="btn btn-success btn-form-offset-lg" ng-click="ctrl.dodajStavku()">
                            <i class="fa fa-plus"></i> Dodaj stavku
                        </button>
                    </div>
                </div>
            </form>

            <div class="overflow-x-auto mt-3">
                <div class="w-max-content w-sm-100">
                    <div class="card card-body p-0 mt-3">
                        <table class="table table-nowrap mb-0">
                            <thead>
                            <tr>
                                <th style="width: 1px;">Koli훾ina</th>
                                <th style="width: 1px;"></th>
                                <th>Artikal</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="stavka in ctrl.prijemnica.stavke" ng-click="ctrl.obrisiStavku($index)">
                                <td class="text-end" style="width: 1px;">{{ stavka.kolicina }}</td>
                                <td style="width: 1px;">x</td>
                                <td>{{ stavka.artikal.naziv }}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="mt-3"></div>
    <div class="d-flex flex-column-reverse flex-md-row justify-content-end gap-3">
        <button class="btn btn-light border" ui-sref="artikal-pregled-lista">
            <i class="fa fa-close"></i> Odustani
        </button>
        <button class="btn btn-success" ng-click="ctrl.upis()">
            Sa훾uvaj prijemnicu
        </button>
    </div>
</div>